<html lang="en">
<head>
<title>Input Streams - GNU Emacs Lisp Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Emacs Lisp Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Read-and-Print.html#Read-and-Print" title="Read and Print">
<link rel="prev" href="Streams-Intro.html#Streams-Intro" title="Streams Intro">
<link rel="next" href="Input-Functions.html#Input-Functions" title="Input Functions">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This is edition 3.0 of the GNU Emacs Lisp Reference Manual,

corresponding to Emacs version 23.2.50.

Copyright (C) 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1998,
1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010  Free Software
Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with the Invariant Sections being ``GNU General Public
     License,'' with the Front-Cover texts being ``A GNU Manual,'' and
     with the Back-Cover Texts as in (a) below.  A copy of the license
     is included in the section entitled ``GNU Free Documentation
     License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="stylesheet" href="aquamacs.css" type="text/css" /></head>
<body>
<div class="node">
<a name="Input-Streams"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Input-Functions.html#Input-Functions">Input Functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Streams-Intro.html#Streams-Intro">Streams Intro</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Read-and-Print.html#Read-and-Print">Read and Print</a>
<hr>
</div>

<h3 class="section">19.2 Input Streams</h3>

<p><a name="index-stream-_0028for-reading_0029-1027"></a><a name="index-input-stream-1028"></a>
  Most of the Lisp functions for reading text take an <dfn>input stream</dfn>
as an argument.  The input stream specifies where or how to get the
characters of the text to be read.  Here are the possible types of input
stream:

     <dl>
<dt><var>buffer</var><dd><a name="index-buffer-input-stream-1029"></a>The input characters are read from <var>buffer</var>, starting with the
character directly after point.  Point advances as characters are read.

     <br><dt><var>marker</var><dd><a name="index-marker-input-stream-1030"></a>The input characters are read from the buffer that <var>marker</var> is in,
starting with the character directly after the marker.  The marker
position advances as characters are read.  The value of point in the
buffer has no effect when the stream is a marker.

     <br><dt><var>string</var><dd><a name="index-string-input-stream-1031"></a>The input characters are taken from <var>string</var>, starting at the first
character in the string and using as many characters as required.

     <br><dt><var>function</var><dd><a name="index-function-input-stream-1032"></a>The input characters are generated by <var>function</var>, which must support
two kinds of calls:

          <ul>
<li>When it is called with no arguments, it should return the next character.

          <li>When it is called with one argument (always a character), <var>function</var>
should save the argument and arrange to return it on the next call. 
This is called <dfn>unreading</dfn> the character; it happens when the Lisp
reader reads one character too many and wants to &ldquo;put it back where it
came from.&rdquo;  In this case, it makes no difference what value
<var>function</var> returns. 
</ul>

     <br><dt><code>t</code><dd><a name="index-g_t_0040code_007bt_007d-input-stream-1033"></a><code>t</code> used as a stream means that the input is read from the
minibuffer.  In fact, the minibuffer is invoked once and the text
given by the user is made into a string that is then used as the
input stream.  If Emacs is running in batch mode, standard input is used
instead of the minibuffer.  For example,
     <pre class="example">          (message "%s" (read t))
</pre>
     <p>will read a Lisp expression from standard input and print the result
to standard output.

     <br><dt><code>nil</code><dd><a name="index-g_t_0040code_007bnil_007d-input-stream-1034"></a><code>nil</code> supplied as an input stream means to use the value of
<code>standard-input</code> instead; that value is the <dfn>default input
stream</dfn>, and must be a non-<code>nil</code> input stream.

     <br><dt><var>symbol</var><dd>A symbol as input stream is equivalent to the symbol's function
definition (if any). 
</dl>

   <p>Here is an example of reading from a stream that is a buffer, showing
where point is located before and after:

<pre class="example">     ---------- Buffer: foo ----------
     This-!- is the contents of foo.
     ---------- Buffer: foo ----------
     
     (read (get-buffer "foo"))
          &rArr; is
     (read (get-buffer "foo"))
          &rArr; the
     
     ---------- Buffer: foo ----------
     This is the-!- contents of foo.
     ---------- Buffer: foo ----------
</pre>
   <p class="noindent">Note that the first read skips a space.  Reading skips any amount of
whitespace preceding the significant text.

   <p>Here is an example of reading from a stream that is a marker,
initially positioned at the beginning of the buffer shown.  The value
read is the symbol <code>This</code>.

<pre class="example">     
     ---------- Buffer: foo ----------
     This is the contents of foo.
     ---------- Buffer: foo ----------
     
     (setq m (set-marker (make-marker) 1 (get-buffer "foo")))
          &rArr; #&lt;marker at 1 in foo&gt;
     (read m)
          &rArr; This
     m
          &rArr; #&lt;marker at 5 in foo&gt;   ;; <span class="roman">Before the first space.</span>
</pre>
   <p>Here we read from the contents of a string:

<pre class="example">     (read "(When in) the course")
          &rArr; (When in)
</pre>
   <p>The following example reads from the minibuffer.  The
prompt is: &lsquo;<samp><span class="samp">Lisp&nbsp;expression:&nbsp;</span></samp>&rsquo;<!-- /@w -->.  (That is always the prompt
used when you read from the stream <code>t</code>.)  The user's input is shown
following the prompt.

<pre class="example">     (read t)
          &rArr; 23
     ---------- Buffer: Minibuffer ----------
     Lisp expression: <kbd>23 &lt;RET&gt;</kbd>
     ---------- Buffer: Minibuffer ----------
</pre>
   <p>Finally, here is an example of a stream that is a function, named
<code>useless-stream</code>.  Before we use the stream, we initialize the
variable <code>useless-list</code> to a list of characters.  Then each call to
the function <code>useless-stream</code> obtains the next character in the list
or unreads a character by adding it to the front of the list.

<pre class="example">     (setq useless-list (append "XY()" nil))
          &rArr; (88 89 40 41)
     
     (defun useless-stream (&amp;optional unread)
       (if unread
           (setq useless-list (cons unread useless-list))
         (prog1 (car useless-list)
                (setq useless-list (cdr useless-list)))))
          &rArr; useless-stream
</pre>
   <p class="noindent">Now we read using the stream thus constructed:

<pre class="example">     (read 'useless-stream)
          &rArr; XY
     
     useless-list
          &rArr; (40 41)
</pre>
   <p class="noindent">Note that the open and close parentheses remain in the list.  The Lisp
reader encountered the open parenthesis, decided that it ended the
input, and unread it.  Another attempt to read from the stream at this
point would read &lsquo;<samp><span class="samp">()</span></samp>&rsquo; and return <code>nil</code>.

<div class="defun">
&mdash; Function: <b>get-file-char</b><var><a name="index-get_002dfile_002dchar-1035"></a></var><br>
<blockquote><p>This function is used internally as an input stream to read from the
input file opened by the function <code>load</code>.  Don't use this function
yourself. 
</p></blockquote></div>

   </body></html>


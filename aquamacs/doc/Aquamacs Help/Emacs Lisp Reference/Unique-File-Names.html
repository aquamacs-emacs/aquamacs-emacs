<html lang="en">
<head>
<title>Unique File Names - GNU Emacs Lisp Reference Manual</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="GNU Emacs Lisp Reference Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="File-Names.html#File-Names" title="File Names">
<link rel="prev" href="File-Name-Expansion.html#File-Name-Expansion" title="File Name Expansion">
<link rel="next" href="File-Name-Completion.html#File-Name-Completion" title="File Name Completion">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This is the `GNU Emacs Lisp Reference Manual'
corresponding to Emacs version 24.3.50.

Copyright (C) 1990--1996, 1998--2013 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with the Invariant Sections being ``GNU General Public
     License,'' with the Front-Cover texts being ``A GNU Manual,'' and
     with the Back-Cover Texts as in (a) below.  A copy of the license
     is included in the section entitled ``GNU Free Documentation
     License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">

<link rel="stylesheet" href="aquamacs.css" type="text/css" /></head>
<body>
<div class="node">
<a name="Unique-File-Names"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="File-Name-Completion.html#File-Name-Completion">File Name Completion</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="File-Name-Expansion.html#File-Name-Expansion">File Name Expansion</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="File-Names.html#File-Names">File Names</a>
<hr>
</div>

<h4 class="subsection">25.8.5 Generating Unique File Names</h4>

<p>Some programs need to write temporary files.  Here is the usual way to
construct a name for such a file:

<pre class="example">     (make-temp-file <var>name-of-application</var>)
</pre>
   <p class="noindent">The job of <code>make-temp-file</code> is to prevent two different users or
two different jobs from trying to use the exact same file name.

<div class="defun">
&mdash; Function: <b>make-temp-file</b><var> prefix &amp;optional dir-flag suffix<a name="index-make_002dtemp_002dfile-2026"></a></var><br>
<blockquote><p>This function creates a temporary file and returns its name.  Emacs
creates the temporary file's name by adding to <var>prefix</var> some
random characters that are different in each Emacs job.  The result is
guaranteed to be a newly created empty file.  On MS-DOS, this function
can truncate the <var>string</var> prefix to fit into the 8+3 file-name
limits.  If <var>prefix</var> is a relative file name, it is expanded
against <code>temporary-file-directory</code>.

     <pre class="example">          (make-temp-file "foo")
               &rArr; "/tmp/foo232J6v"
</pre>
        <p>When <code>make-temp-file</code> returns, the file has been created and is
empty.  At that point, you should write the intended contents into the
file.

        <p>If <var>dir-flag</var> is non-<code>nil</code>, <code>make-temp-file</code> creates an
empty directory instead of an empty file.  It returns the file name,
not the directory name, of that directory.  See <a href="Directory-Names.html#Directory-Names">Directory Names</a>.

        <p>If <var>suffix</var> is non-<code>nil</code>, <code>make-temp-file</code> adds it at
the end of the file name.

        <p>To prevent conflicts among different libraries running in the same
Emacs, each Lisp program that uses <code>make-temp-file</code> should have its
own <var>prefix</var>.  The number added to the end of <var>prefix</var>
distinguishes between the same application running in different Emacs
jobs.  Additional added characters permit a large number of distinct
names even in one Emacs job. 
</p></blockquote></div>

   <p>The default directory for temporary files is controlled by the
variable <code>temporary-file-directory</code>.  This variable gives the user
a uniform way to specify the directory for all temporary files.  Some
programs use <code>small-temporary-file-directory</code> instead, if that is
non-<code>nil</code>.  To use it, you should expand the prefix against
the proper directory before calling <code>make-temp-file</code>.

<div class="defun">
&mdash; User Option: <b>temporary-file-directory</b><var><a name="index-temporary_002dfile_002ddirectory-2027"></a></var><br>
<blockquote><p><a name="index-g_t_0040env_007bTMPDIR_007d-environment-variable-2028"></a><a name="index-g_t_0040env_007bTMP_007d-environment-variable-2029"></a><a name="index-g_t_0040env_007bTEMP_007d-environment-variable-2030"></a>This variable specifies the directory name for creating temporary files. 
Its value should be a directory name (see <a href="Directory-Names.html#Directory-Names">Directory Names</a>), but it
is good for Lisp programs to cope if the value is a directory's file
name instead.  Using the value as the second argument to
<code>expand-file-name</code> is a good way to achieve that.

        <p>The default value is determined in a reasonable way for your operating
system; it is based on the <samp><span class="env">TMPDIR</span></samp>, <samp><span class="env">TMP</span></samp> and <samp><span class="env">TEMP</span></samp>
environment variables, with a fall-back to a system-dependent name if
none of these variables is defined.

        <p>Even if you do not use <code>make-temp-file</code> to create the temporary
file, you should still use this variable to decide which directory to
put the file in.  However, if you expect the file to be small, you
should use <code>small-temporary-file-directory</code> first if that is
non-<code>nil</code>. 
</p></blockquote></div>

<div class="defun">
&mdash; User Option: <b>small-temporary-file-directory</b><var><a name="index-small_002dtemporary_002dfile_002ddirectory-2031"></a></var><br>
<blockquote><p>This variable specifies the directory name for
creating certain temporary files, which are likely to be small.

        <p>If you want to write a temporary file which is likely to be small, you
should compute the directory like this:

     <pre class="example">          (make-temp-file
            (expand-file-name <var>prefix</var>
                              (or small-temporary-file-directory
                                  temporary-file-directory)))
</pre>
        </blockquote></div>

<div class="defun">
&mdash; Function: <b>make-temp-name</b><var> base-name<a name="index-make_002dtemp_002dname-2032"></a></var><br>
<blockquote><p>This function generates a string that can be used as a unique file
name.  The name starts with <var>base-name</var>, and has several random
characters appended to it, which are different in each Emacs job.  It
is like <code>make-temp-file</code> except that (i) it just constructs a
name, and does not create a file, and (ii) <var>base-name</var> should be
an absolute file name (on MS-DOS, this function can truncate
<var>base-name</var> to fit into the 8+3 file-name limits).

        <p><strong>Warning:</strong> In most cases, you should not use this function; use
<code>make-temp-file</code> instead!  This function is susceptible to a race
condition, between the <code>make-temp-name</code> call and the creation of
the file, which in some cases may cause a security hole. 
</p></blockquote></div>

   </body></html>


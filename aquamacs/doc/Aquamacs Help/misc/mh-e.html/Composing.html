<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This is version 8.6 of The MH-E
Manual, last updated 2016-04-29.

Copyright (C) 1995, 2001-2003, 2005-2016 Free Software
Foundation, Inc.


Permission is granted to copy, distribute and/or modify this document
under the terms of either:

a. the GNU Free Documentation License, Version 1.3 or any later version
published by the Free Software Foundation; with no Invariant Sections,
with the Front-Cover Texts being "A GNU Manual," and with the
Back-Cover Texts as in (a) below. A copy of the license is included in
the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."

b. the GNU General Public License as published by the Free Software
Foundation; either version 3, or (at your option) any later version. A
copy of the license is included in the section entitled "GNU General
Public License."
 -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.18.1), see www.w3.org" />

  <title>The MH-E Manual: Composing</title>
  <meta name="description" content="The MH-E Manual: Composing" />
  <meta name="keywords" content="The MH-E Manual: Composing" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Sending-Mail.html#Sending-Mail" rel="up" title=
  "Sending Mail" />
  <link href="Replying.html#Replying" rel="next" title=
  "Replying" />
  <link href="Sending-Mail.html#Sending-Mail" rel="prev" title=
  "Sending Mail" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Composing" id="Composing"></a>

  <div class="header">
    <p>Next: <a href="Replying.html#Replying" accesskey="n" rel=
    "next">Replying</a>, Previous: <a href=
    "Sending-Mail.html#Sending-Mail" accesskey="p" rel=
    "prev">Sending Mail</a>, Up: <a href=
    "Sending-Mail.html#Sending-Mail" accesskey="u" rel="up">Sending
    Mail</a> &nbsp; [<a href="index.html#SEC_Contents" title=
    "Table of contents" rel="contents">Contents</a>][<a href=
    "Key-Index.html#Key-Index" title="Index" rel=
    "index">Index</a>]</p>
  </div>
  <hr />
  <a name="Composing-1" id="Composing-1"></a>

  <h3 class="section">8.1 Composing</h3><a name=
  "index-_002eemacs-5" id="index-_002eemacs-5"></a> <a name=
  "index-MH_002dFolder-mode-7" id="index-MH_002dFolder-mode-7"></a>
  <a name="index-composing-mail" id="index-composing-mail"></a>
  <a name="index-draft" id="index-draft"></a> <a name=
  "index-files_002c-_002eemacs-5" id=
  "index-files_002c-_002eemacs-5"></a> <a name=
  "index-modes_002c-MH_002dFolder-7" id=
  "index-modes_002c-MH_002dFolder-7"></a> <a name=
  "index-sending-mail-2" id="index-sending-mail-2"></a> <a name=
  "index-mh_002dsmail-4" id="index-mh_002dsmail-4"></a> <a name=
  "index-mh_002dsmail_002dother_002dwindow-1" id=
  "index-mh_002dsmail_002dother_002dwindow-1"></a> <a name=
  "index-M_002dx-mh_002dsmail-3" id=
  "index-M_002dx-mh_002dsmail-3"></a> <a name=
  "index-M_002dx-mh_002dsmail_002dother_002dwindow" id=
  "index-M_002dx-mh_002dsmail_002dother_002dwindow"></a>

  <p>Outside of an MH-Folder buffer, you must call either <kbd>M-x
  mh-smail</kbd> or <kbd>M-x mh-smail-other-window</kbd> to compose
  a new message. The former command always creates a two-window
  layout with the current buffer on top and the draft on the
  bottom. Use the latter command if you would rather preserve the
  window layout. You may find adding the following key bindings to
  <samp>~/.emacs</samp> useful:</p>

  <div class="smalllisp">
    <pre class="smalllisp">
(global-set-key "\C-xm" 'mh-smail)
(global-set-key "\C-x4m" 'mh-smail-other-window)
</pre>
  </div><a name="index-draft-folder" id="index-draft-folder"></a>
  <a name="index-MH_002dLetter-mode-1" id=
  "index-MH_002dLetter-mode-1"></a> <a name=
  "index-modes_002c-MH_002dLetter-1" id=
  "index-modes_002c-MH_002dLetter-1"></a> <a name=
  "index-mh_002dsend-1" id="index-mh_002dsend-1"></a> <a name=
  "index-m-1" id="index-m-1"></a>

  <p>From within a MH-Folder buffer, you can simply use the command
  <kbd>m</kbd> (<code>mh-send</code>). However you invoke
  <code>mh-send</code>, your letter appears in an Emacs buffer
  whose mode is MH-Letter (to see what the buffer looks like, see
  <a href="Sending-Mail-Tour.html#Sending-Mail-Tour">Sending Mail
  Tour</a>). MH-Letter mode allows you to edit your message, to
  check the validity of the recipients, to insert attachments and
  other messages into your message, and to send the message.
  We&rsquo;ll go more into depth about editing a
  <em>draft</em><a name="DOCF30" href="#FOOT30" id=
  "DOCF30"><sup>30</sup></a> (a message you&rsquo;re composing) in
  just a moment (see <a href=
  "Editing-Drafts.html#Editing-Drafts">Editing
  Drafts</a>).</p><a name=
  "index-mh_002dcompose_002dprompt_002dflag-1" id=
  "index-mh_002dcompose_002dprompt_002dflag-1"></a>

  <p>If you prefer to be prompted for the recipient and subject
  fields before the MH-Letter buffer appears, turn on the option
  <code>mh-compose-prompt-flag</code>.</p><a name=
  "index-header-field_002c-X_002dMailer" id=
  "index-header-field_002c-X_002dMailer"></a> <a name=
  "index-X_002dMailer-header-field" id=
  "index-X_002dMailer-header-field"></a> <a name=
  "index-mh_002dinsert_002dx_002dmailer_002dflag-1" id=
  "index-mh_002dinsert_002dx_002dmailer_002dflag-1"></a>

  <p>MH-E adds an &lsquo;<samp>X-Mailer:</samp>&rsquo; header field
  to the header that includes the version of MH-E and Emacs that
  you are using. If you don&rsquo;t want to participate in our
  marketing, you can turn off the option
  <code>mh-insert-x-mailer-flag</code>.</p><a name="index-repl" id=
  "index-repl"></a> <a name="index-components" id=
  "index-components"></a> <a name="index-MH-commands_002c-repl" id=
  "index-MH-commands_002c-repl"></a> <a name=
  "index-MH_002dLetter-mode-2" id="index-MH_002dLetter-mode-2"></a>
  <a name="index-Mail-mode" id="index-Mail-mode"></a> <a name=
  "index-files_002c-components" id=
  "index-files_002c-components"></a> <a name=
  "index-modes_002c-MH_002dLetter-2" id=
  "index-modes_002c-MH_002dLetter-2"></a> <a name=
  "index-modes_002c-Mail" id="index-modes_002c-Mail"></a> <a name=
  "index-mail_002dmode_002dhook" id=
  "index-mail_002dmode_002dhook"></a> <a name=
  "index-mh_002dletter_002dmode_002dhook-1" id=
  "index-mh_002dletter_002dmode_002dhook-1"></a> <a name=
  "index-text_002dmode_002dhook" id=
  "index-text_002dmode_002dhook"></a>

  <p>Two hooks are provided to run commands on your freshly created
  draft. The first hook, <code>mh-letter-mode-hook</code>, allows
  you to do some processing before editing a letter<a name="DOCF31"
  href="#FOOT31" id="DOCF31"><sup>31</sup></a>. For example, you
  may wish to modify the header after <code>repl</code> has done
  its work, or you may have a complicated <samp>components</samp>
  file and need to tell MH-E where the cursor should go.
  Here&rsquo;s an example of how you would use this
  hook.</p><a name="index-mh_002dinsert_002dsignature_002c-example"
  id="index-mh_002dinsert_002dsignature_002c-example"></a>

  <div class="smalllisp">
    <pre class="smalllisp">
(defvar letter-mode-init-done-flag nil
  "Non-nil means one-time MH-E settings have been made.")

(defun my-mh-letter-mode-hook ()
  "Prepare letter for editing."
  (when (not letter-mode-init-done)     ; <span class=
"roman">only need to bind the keys once</span>
    (local-set-key "\C-ctb" 'add-enriched-text)
    (local-set-key "\C-cti" 'add-enriched-text)
    (local-set-key "\C-ctf" 'add-enriched-text)
    (local-set-key "\C-cts" 'add-enriched-text)
    (local-set-key "\C-ctB" 'add-enriched-text)
    (local-set-key "\C-ctu" 'add-enriched-text)
    (local-set-key "\C-ctc" 'add-enriched-text)
    (setq letter-mode-init-done t))
  (save-excursion
    (goto-char (point-max))             ; <span class=
"roman">go to end of message to</span>
    (mh-insert-signature)))             ;   <span class=
"roman">insert signature</span>

<i>Prepare draft for editing via mh-letter-mode-hook</i>

</pre>
  </div>

  <p>The function, <code>add-enriched-text</code> is defined in the
  example in <a href=
  "Adding-Attachments.html#Adding-Attachments">Adding
  Attachments</a>.</p><a name=
  "index-mh_002dcompose_002dletter_002dfunction-1" id=
  "index-mh_002dcompose_002dletter_002dfunction-1"></a> <a name=
  "index-mh_002dletter_002dmode_002dhook-2" id=
  "index-mh_002dletter_002dmode_002dhook-2"></a>

  <p>The second hook, a function really, is
  <code>mh-compose-letter-function</code>. Like
  <code>mh-letter-mode-hook</code>, it is called just before
  editing a new message; however, it is the last function called
  before you edit your message. The consequence of this is that you
  can write a function to write and send the message for you. This
  function is passed three arguments: the contents of the
  &lsquo;<samp>To:</samp>&rsquo;,
  &lsquo;<samp>Subject:</samp>&rsquo;, and
  &lsquo;<samp>Cc:</samp>&rsquo; header fields.</p>

  <div class="footnote">
    <hr />

    <h4 class="footnotes-heading">Footnotes</h4>

    <h3><a name="FOOT30" href="#DOCF30" id="FOOT30">(30)</a></h3>

    <p>I highly recommend that you use a <em>draft folder</em> so
    that you can edit several drafts in parallel. To do so, create
    a folder named &lsquo;<samp>+drafts</samp>&rsquo; for example,
    and add the profile component &lsquo;<samp>Draft-Folder:
    drafts</samp>&rsquo; (see <code>mh-profile</code>(5)).</p>

    <h3><a name="FOOT31" href="#DOCF31" id="FOOT31">(31)</a></h3>

    <p>Actually, because MH-Letter mode inherits from Mail mode,
    the hooks <code>text-mode-hook</code> and
    <code>mail-mode-hook</code> are run (in that order) before
    <code>mh-letter-mode-hook</code>.</p>
  </div>
  <hr />

  <div class="header">
    <p>Next: <a href="Replying.html#Replying" accesskey="n" rel=
    "next">Replying</a>, Previous: <a href=
    "Sending-Mail.html#Sending-Mail" accesskey="p" rel=
    "prev">Sending Mail</a>, Up: <a href=
    "Sending-Mail.html#Sending-Mail" accesskey="u" rel="up">Sending
    Mail</a> &nbsp; [<a href="index.html#SEC_Contents" title=
    "Table of contents" rel="contents">Contents</a>][<a href=
    "Key-Index.html#Key-Index" title="Index" rel=
    "index">Index</a>]</p>
  </div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This file documents Calc, the GNU Emacs calculator, included with
GNU Emacs 25.1.

Copyright (C) 1990-1991, 2001-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being just "GNU GENERAL PUBLIC LICENSE", with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.18.1), see www.w3.org" />

  <title>GNU Emacs Calc Manual: Programming Answer 9</title>
  <meta name="description" content=
  "GNU Emacs Calc Manual: Programming Answer 9" />
  <meta name="keywords" content=
  "GNU Emacs Calc Manual: Programming Answer 9" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Answers-to-Exercises.html#Answers-to-Exercises" rel=
  "up" title="Answers to Exercises" />
  <link href="Programming-Answer-10.html#Programming-Answer-10"
  rel="next" title="Programming Answer 10" />
  <link href="Programming-Answer-8.html#Programming-Answer-8" rel=
  "prev" title="Programming Answer 8" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Programming-Answer-9" id="Programming-Answer-9"></a>

  <div class="header">
    <p>Next: <a href=
    "Programming-Answer-10.html#Programming-Answer-10" accesskey=
    "n" rel="next">Programming Answer 10</a>, Previous: <a href=
    "Programming-Answer-8.html#Programming-Answer-8" accesskey="p"
    rel="prev">Programming Answer 8</a>, Up: <a href=
    "Answers-to-Exercises.html#Answers-to-Exercises" accesskey="u"
    rel="up">Answers to Exercises</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
  <hr />
  <a name="Programming-Tutorial-Exercise-9" id=
  "Programming-Tutorial-Exercise-9"></a>

  <h4 class="subsection">2.7.66 Programming Tutorial Exercise
  9</h4>

  <p>The first step is to adjust &lsquo;<samp>z</samp>&rsquo; to be
  greater than 5. A simple &ldquo;for&rdquo; loop will do the job
  here. If &lsquo;<samp>z</samp>&rsquo; is less than 5, we reduce
  the problem using &lsquo;<samp>psi(z) = psi(z+1) -
  1/z</samp>&rsquo;. We go on to compute
  &lsquo;<samp>psi(z+1)</samp>&rsquo;, and remember to add back a
  factor of &lsquo;<samp>-1/z</samp>&rsquo; when we&rsquo;re done.
  This step is repeated until &lsquo;<samp>z &gt;
  5</samp>&rsquo;.</p>

  <p>(Because this definition is long, it will be repeated in
  concise form below. You can use <kbd><span class=
  "nolinebreak">C-x</span>&nbsp;*&nbsp;m</kbd><!-- /@w --> to load
  it from there. While you are entering a <kbd>Z ` Z '</kbd> body
  in a macro, Calc simply collects keystrokes without executing
  them. In the following diagrams we&rsquo;ll pretend Calc actually
  executed the keystrokes as you typed them, just for purposes of
  illustration.)</p>

  <div class="smallexample">
    <pre class="smallexample">
1:  1.             1:  1.
    .                  .

 1.0 <span class="key">RET</span>       C-x ( Z `  s 1  0 t 2
</pre>
  </div>

  <p>Here, variable 1 holds &lsquo;<samp>z</samp>&rsquo; and
  variable 2 holds the adjustment factor. If &lsquo;<samp>z &lt;
  5</samp>&rsquo;, we use a loop to increase it.</p>

  <p>(By the way, we started with &lsquo;<samp>1.0</samp>&rsquo;
  instead of the integer 1 because otherwise the calculation below
  will try to do exact fractional arithmetic, and will never
  converge because fractions compare equal only if they are exactly
  equal, not just equal to within the current precision.)</p>

  <div class="smallexample">
    <pre class="smallexample">
3:  1.      2:  1.       1:  6.
2:  1.      1:  1            .
1:  5           .
    .

  <span class=
"key">RET</span> 5        a &lt;    Z [  5 Z (  &amp; s + 2  1 s + 1  1 Z ) r 1  Z ]
</pre>
  </div>

  <p>Now we compute the initial part of the sum: &lsquo;<samp>ln(z)
  - 1/2z</samp>&rsquo; minus the adjustment factor.</p>

  <div class="smallexample">
    <pre class="smallexample">
2:  1.79175946923      2:  1.7084261359      1:  -0.57490719743
1:  0.0833333333333    1:  2.28333333333         .
    .                      .

    L  r 1 2 * &amp;           -  r 2                -
</pre>
  </div>

  <p>Now we evaluate the series. We&rsquo;ll use another
  &ldquo;for&rdquo; loop counting up the value of &lsquo;<samp>2
  n</samp>&rsquo;. (Calc does have a summation command, <kbd>a
  +</kbd>, but we&rsquo;ll use loops just to get more practice with
  them.)</p>

  <div class="smallexample">
    <pre class="smallexample">
3:  -0.5749       3:  -0.5749        4:  -0.5749      2:  -0.5749
2:  2             2:  1:6            3:  1:6          1:  2.3148e-3
1:  40            1:  2              2:  2                .
    .                 .              1:  36.
                                         .

   2 <span class="key">RET</span> 40        Z ( <span class=
"key">RET</span> k b <span class="key">TAB</span>     <span class=
"key">RET</span> r 1 <span class="key">TAB</span> ^      * /

</pre>
  </div>

  <div class="smallexample">
    <pre class="smallexample">
3:  -0.5749       3:  -0.5772      2:  -0.5772     1:  -0.577215664892
2:  -0.5749       2:  -0.5772      1:  0               .
1:  2.3148e-3     1:  -0.5749          .
    .                 .

  <span class="key">TAB</span> <span class=
"key">RET</span> M-<span class=
"key">TAB</span>       - <span class="key">RET</span> M-<span class="key">TAB</span>      a =     Z /    2  Z )  Z ' C-x )
</pre>
  </div>

  <p>This is the value of &lsquo;<samp>- gamma</samp>&rsquo;, with
  a slight bit of roundoff error. To get a full 12 digits,
  let&rsquo;s use a higher precision:</p>

  <div class="smallexample">
    <pre class="smallexample">
2:  -0.577215664892      2:  -0.577215664892
1:  1.                   1:  -0.577215664901532

    1. <span class=
"key">RET</span>                   p 16 <span class=
"key">RET</span> X
</pre>
  </div>

  <p>Here&rsquo;s the complete sequence of keystrokes:</p>

  <div class="example">
    <pre class="example">
C-x ( Z `  s 1  0 t 2
           <span class=
"key">RET</span> 5 a &lt;  Z [  5 Z (  &amp; s + 2  1 s + 1  1 Z ) r 1  Z ]
           L r 1 2 * &amp; - r 2 -
           2 <span class="key">RET</span> 40  Z (  <span class=
"key">RET</span> k b <span class="key">TAB</span> <span class=
"key">RET</span> r 1 <span class="key">TAB</span> ^ * /
                          <span class="key">TAB</span> <span class=
"key">RET</span> M-<span class="key">TAB</span> - <span class=
"key">RET</span> M-<span class="key">TAB</span> a = Z /
                  2  Z )
      Z '
C-x )
</pre>
  </div>
  <hr />

  <div class="header">
    <p>Next: <a href=
    "Programming-Answer-10.html#Programming-Answer-10" accesskey=
    "n" rel="next">Programming Answer 10</a>, Previous: <a href=
    "Programming-Answer-8.html#Programming-Answer-8" accesskey="p"
    rel="prev">Programming Answer 8</a>, Up: <a href=
    "Answers-to-Exercises.html#Answers-to-Exercises" accesskey="u"
    rel="up">Answers to Exercises</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
</body>
</html>

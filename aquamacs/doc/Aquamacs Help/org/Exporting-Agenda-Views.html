<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.18.1), see www.w3.org" />

  <title>Exporting Agenda Views - The Org Manual</title>
  <meta http-equiv="Content-Type" content="text/html" />
  <meta name="description" content="The Org Manual" />
  <meta name="generator" content="makeinfo 4.13" />
  <link title="Top" rel="start" href="index.html#Top" />
  <link rel="up" href="Agenda-Views.html#Agenda-Views" title=
  "Agenda Views" />
  <link rel="prev" href=
  "Custom-agenda-views.html#Custom-agenda-views" title=
  "Custom agenda views" />
  <link rel="next" href=
  "Agenda-column-view.html#Agenda-column-view" title=
  "Agenda column view" />
  <link href="http://www.gnu.org/software/texinfo/" rel=
  "generator-home" title="Texinfo Homepage" /><!--
This manual is for Org version 7.4.

Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010
Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''

     This document is part of a collection distributed under the GNU
     Free Documentation License.  If you want to distribute this
     document separately from the collection, you can do so by adding a
     copy of the license to the document, as described in section 6 of
     the license.
   -->
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
  -->
  /*]]>*/
  </style>
</head>

<body>
  <div class="node">
    <a name="Exporting-Agenda-Views" id=
    "Exporting-Agenda-Views"></a>

    <p>Next:&nbsp;<a rel="next" accesskey="n" href=
    "Agenda-column-view.html#Agenda-column-view">Agenda column
    view</a>, Previous:&nbsp;<a rel="previous" accesskey="p" href=
    "Custom-agenda-views.html#Custom-agenda-views">Custom agenda
    views</a>, Up:&nbsp;<a rel="up" accesskey="u" href=
    "Agenda-Views.html#Agenda-Views">Agenda Views</a></p>
    <hr />
  </div>

  <h3 class="section">10.7 Exporting Agenda Views</h3>

  <p><a name="index-agenda-views_002c-exporting-1290" id=
  "index-agenda-views_002c-exporting-1290"></a> If you are away
  from your computer, it can be very useful to have a printed
  version of some agenda views to carry around. Org-mode can export
  custom agenda views as plain text, HTML<a rel="footnote" href=
  "#fn-1" name="fnd-1" id="fnd-1"><sup>1</sup></a>, Postscript,
  PDF<a rel="footnote" href="#fn-2" name="fnd-2" id=
  "fnd-2"><sup>2</sup></a>, and iCalendar files. If you want to do
  this only occasionally, use the command <a name=
  "index-C_002dx-C_002dw-1291" id="index-C_002dx-C_002dw-1291"></a>
  <a name="index-org_002dwrite_002dagenda-1292" id=
  "index-org_002dwrite_002dagenda-1292"></a></p>

  <dl>
    <dt><kbd>C-x C-w
    &nbsp;&nbsp;&nbsp;&nbsp;(</kbd><code>org-write-agenda</code><kbd>)</kbd></dt>

    <dd>
      <a name="index-exporting-agenda-views-1293" id=
      "index-exporting-agenda-views-1293"></a><a name=
      "index-agenda-views_002c-exporting-1294" id=
      "index-agenda-views_002c-exporting-1294"></a><a name=
      "index-org_002dagenda_002dexporter_002dsettings-1295" id=
      "index-org_002dagenda_002dexporter_002dsettings-1295"></a>Write
      the agenda view to a file. Depending on the extension of the
      selected file name, the view will be exported as HTML
      (extension <samp><span class="file">.html</span></samp> or
      <samp><span class="file">.htm</span></samp>), Postscript
      (extension <samp><span class="file">.ps</span></samp>),
      iCalendar (extension <samp><span class=
      "file">.ics</span></samp>), or plain text (any other
      extension). Use the variable
      <code>org-agenda-exporter-settings</code> to set options for
      <samp><span class="file">ps-print</span></samp> and for
      <samp><span class="file">htmlize</span></samp> to be used
      during export, for example

      <p><a name=
      "index-org_002dagenda_002dadd_002dentry_002dtext_002dmaxlines-1296"
      id=
      "index-org_002dagenda_002dadd_002dentry_002dtext_002dmaxlines-1296">
      </a><a name="index-htmlize_002doutput_002dtype-1297" id=
      "index-htmlize_002doutput_002dtype-1297"></a><a name=
      "index-ps_002dnumber_002dof_002dcolumns-1298" id=
      "index-ps_002dnumber_002dof_002dcolumns-1298"></a><a name=
      "index-ps_002dlandscape_002dmode-1299" id=
      "index-ps_002dlandscape_002dmode-1299"></a></p>
      <pre class="lisp">
          (setq org-agenda-exporter-settings
                '((ps-number-of-columns 2)
                  (ps-landscape-mode t)
                  (org-agenda-add-entry-text-maxlines 5)
                  (htmlize-output-type 'css)))
</pre>
    </dd>
  </dl>

  <p>If you need to export certain agenda views frequently, you can
  associate any custom agenda command with a list of output file
  names <a rel="footnote" href="#fn-3" name="fnd-3" id=
  "fnd-3"><sup>3</sup></a>. Here is an example that first defines
  custom commands for the agenda and the global TODO list, together
  with a number of files to which to export them. Then we define
  two block agenda commands and specify file names for them as
  well. File names can be relative to the current working
  directory, or absolute.</p>
  <pre class="lisp">
     (setq org-agenda-custom-commands
           '(("X" agenda "" nil ("agenda.html" "agenda.ps"))
             ("Y" alltodo "" nil ("todo.html" "todo.txt" "todo.ps"))
             ("h" "Agenda and Home-related tasks"
              ((agenda "")
               (tags-todo "home")
               (tags "garden"))
              nil
              ("~/views/home.html"))
             ("o" "Agenda and Office-related tasks"
              ((agenda)
               (tags-todo "work")
               (tags "office"))
              nil
              ("~/views/office.ps" "~/calendars/office.ics"))))
</pre>

  <p>The extension of the file name determines the type of export.
  If it is <samp><span class="file">.html</span></samp>, Org-mode
  will use the <samp><span class="file">htmlize.el</span></samp>
  package to convert the buffer to HTML and save it to this file
  name. If the extension is <samp><span class=
  "file">.ps</span></samp>, <code>ps-print-buffer-with-faces</code>
  is used to produce Postscript output. If the extension is
  <samp><span class="file">.ics</span></samp>, iCalendar export is
  run export over all files that were used to construct the agenda,
  and limit the export to entries listed in the agenda. Any other
  extension produces a plain ASCII file.</p>

  <p>The export files are <em>not</em> created when you use one of
  those commands interactively because this might use too much
  overhead. Instead, there is a special command to produce
  <em>all</em> specified files in one step: <a name=
  "index-C_002dc-a-e-1300" id="index-C_002dc-a-e-1300"></a>
  <a name="index-org_002dstore_002dagenda_002dviews-1301" id=
  "index-org_002dstore_002dagenda_002dviews-1301"></a></p>

  <dl>
    <dt><kbd>C-c a e
    &nbsp;&nbsp;&nbsp;&nbsp;(</kbd><code>org-store-agenda-views</code><kbd>)</kbd></dt>

    <dd>Export all agenda views that have export file names
    associated with them.</dd>
  </dl>

  <p>You can use the options section of the custom agenda commands
  to also set options for the export commands. For example:</p>
  <pre class="lisp">
     (setq org-agenda-custom-commands
           '(("X" agenda ""
              ((ps-number-of-columns 2)
               (ps-landscape-mode t)
               (org-agenda-prefix-format " [ ] ")
               (org-agenda-with-colors nil)
               (org-agenda-remove-tags t))
              ("theagenda.ps"))))
</pre>

  <p class="noindent">This command sets two options for the
  Postscript exporter, to make it print in two columns in landscape
  format&mdash;the resulting page can be cut in two and then used
  in a paper agenda. The remaining settings modify the agenda
  prefix to omit category and scheduling information, and instead
  include a checkbox to check off items. We also remove the tags to
  make the lines compact, and we don't want to use colors for the
  black-and-white printer. Settings specified in
  <code>org-agenda-exporter-settings</code> will also apply, but
  the settings in <code>org-agenda-custom-commands</code> take
  precedence.</p>

  <p class="noindent">From the command line you may also use</p>
  <pre class="example">
     emacs -f org-batch-store-agenda-views -kill
</pre>

  <p class="noindent">or, if you need to modify some
  parameters<a rel="footnote" href="#fn-4" name="fnd-4" id=
  "fnd-4"><sup>4</sup></a></p>
  <pre class="example">
     emacs -eval '(org-batch-store-agenda-views                      \
                   org-agenda-span month                             \
                   org-agenda-start-day "2007-11-01"                 \
                   org-agenda-include-diary nil                      \
                   org-agenda-files (quote ("~/org/project.org")))'  \
           -kill
</pre>

  <p class="noindent">which will create the agenda views restricted
  to the file <samp><span class=
  "file">~/org/project.org</span></samp>, without diary entries and
  with a 30-day extent.</p>

  <p>You can also extract agenda information in a way that allows
  further processing by other programs. See <a href=
  "Extracting-agenda-information.html#Extracting-agenda-information">
  Extracting agenda information</a>, for more information.</p>

  <div class="footnote">
    <hr />

    <h4>Footnotes</h4>

    <p class="footnote"><small>[<a name="fn-1" href="#fnd-1" id=
    "fn-1">1</a>]</small> You need to install Hrvoje Niksic's
    <samp><span class="file">htmlize.el</span></samp>.</p>

    <p class="footnote"><small>[<a name="fn-2" href="#fnd-2" id=
    "fn-2">2</a>]</small> To create PDF output, the ghostscript
    <samp><span class="file">ps2pdf</span></samp> utility must be
    installed on the system. Selecting a PDF file with also create
    the postscript file.</p>

    <p class="footnote"><small>[<a name="fn-3" href="#fnd-3" id=
    "fn-3">3</a>]</small> If you want to store standard views like
    the weekly agenda or the global TODO list as well, you need to
    define custom commands for them in order to be able to specify
    file names.</p>

    <p class="footnote"><small>[<a name="fn-4" href="#fnd-4" id=
    "fn-4">4</a>]</small> Quoting depends on the system you use,
    please check the FAQ for examples.</p>
    <hr />
  </div>
</body>
</html>

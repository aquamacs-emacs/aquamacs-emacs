<html lang="en">
<head>
<title>Algebraic Manipulation - GNU Emacs Calc Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Emacs Calc Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Algebra.html#Algebra" title="Algebra">
<link rel="prev" href="Selecting-Subformulas.html#Selecting-Subformulas" title="Selecting Subformulas">
<link rel="next" href="Simplifying-Formulas.html#Simplifying-Formulas" title="Simplifying Formulas">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This file documents Calc, the GNU Emacs calculator, included with GNU Emacs 23.1.

Copyright (C) 1990, 1991, 2001, 2002, 2003, 2004,
2005, 2006, 2007, 2008, 2009, 2010 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with the Invariant Sections being just ``GNU GENERAL
     PUBLIC LICENSE'', with the Front-Cover texts being ``A GNU
     Manual,'' and with the Back-Cover Texts as in (a) below.  A copy
     of the license is included in the section entitled ``GNU Free
     Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Algebraic-Manipulation"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Simplifying-Formulas.html#Simplifying-Formulas">Simplifying Formulas</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Selecting-Subformulas.html#Selecting-Subformulas">Selecting Subformulas</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Algebra.html#Algebra">Algebra</a>
<hr>
</div>

<h3 class="section">11.2 Algebraic Manipulation</h3>

<p class="noindent">The commands in this section perform general-purpose algebraic
manipulations.  They work on the whole formula at the top of the
stack (unless, of course, you have made a selection in that
formula).

   <p>Many algebra commands prompt for a variable name or formula.  If you
answer the prompt with a blank line, the variable or formula is taken
from top-of-stack, and the normal argument for the command is taken
from the second-to-top stack level.

   <p><a name="index-a-v-1670"></a><a name="index-calc_002dalg_002devaluate-1671"></a>The <kbd>a v</kbd> (<code>calc-alg-evaluate</code>) command performs the normal
default simplifications on a formula; for example, &lsquo;<samp><span class="samp">a - -b</span></samp>&rsquo; is
changed to &lsquo;<samp><span class="samp">a + b</span></samp>&rsquo;.  These simplifications are normally done
automatically on all Calc results, so this command is useful only if
you have turned default simplifications off with an <kbd>m O</kbd>
command.  See <a href="Simplification-Modes.html#Simplification-Modes">Simplification Modes</a>.

   <p>It is often more convenient to type <kbd>=</kbd>, which is like <kbd>a v</kbd>
but which also substitutes stored values for variables in the formula. 
Use <kbd>a v</kbd> if you want the variables to ignore their stored values.

   <p>If you give a numeric prefix argument of 2 to <kbd>a v</kbd>, it simplifies
as if in Algebraic Simplification mode.  This is equivalent to typing
<kbd>a s</kbd>; see <a href="Simplifying-Formulas.html#Simplifying-Formulas">Simplifying Formulas</a>.  If you give a numeric prefix
of 3 or more, it uses Extended Simplification mode (<kbd>a e</kbd>).

   <p>If you give a negative prefix argument <i>-1</i>, <i>-2</i>, or <i>-3</i>,
it simplifies in the corresponding mode but only works on the top-level
function call of the formula.  For example, &lsquo;<samp><span class="samp">(2 + 3) * (2 + 3)</span></samp>&rsquo; will
simplify to &lsquo;<samp><span class="samp">(2 + 3)^2</span></samp>&rsquo;, without simplifying the sub-formulas
&lsquo;<samp><span class="samp">2 + 3</span></samp>&rsquo;.  As another example, typing <kbd>V R +</kbd> to sum the vector
&lsquo;<samp><span class="samp">[1, 2, 3, 4]</span></samp>&rsquo; produces the formula &lsquo;<samp><span class="samp">reduce(add, [1, 2, 3, 4])</span></samp>&rsquo;
in No-Simplify mode.  Using <kbd>a v</kbd> will evaluate this all the way to
10; using <kbd>C-u - a v</kbd> will evaluate it only to &lsquo;<samp><span class="samp">1 + 2 + 3 + 4</span></samp>&rsquo;. 
(See <a href="Reducing-and-Mapping.html#Reducing-and-Mapping">Reducing and Mapping</a>.)

   <p><a name="index-evalv-1672"></a><a name="index-evalvn-1673"></a>The <kbd>=</kbd> command corresponds to the <code>evalv</code> function, and
the related <kbd>N</kbd> command, which is like <kbd>=</kbd> but temporarily
disables Symbolic mode (<kbd>m s</kbd>) during the evaluation, corresponds
to the <code>evalvn</code> function.  (These commands interpret their prefix
arguments differently than <kbd>a v</kbd>; <kbd>=</kbd> treats the prefix as
the number of stack elements to evaluate at once, and <kbd>N</kbd> treats
it as a temporary different working precision.)

   <p>The <code>evalvn</code> function can take an alternate working precision
as an optional second argument.  This argument can be either an
integer, to set the precision absolutely, or a vector containing
a single integer, to adjust the precision relative to the current
precision.  Note that <code>evalvn</code> with a larger than current
precision will do the calculation at this higher precision, but the
result will as usual be rounded back down to the current precision
afterward.  For example, &lsquo;<samp><span class="samp">evalvn(pi - 3.1415)</span></samp>&rsquo; at a precision
of 12 will return &lsquo;<samp><span class="samp">9.265359e-5</span></samp>&rsquo;; &lsquo;<samp><span class="samp">evalvn(pi - 3.1415, 30)</span></samp>&rsquo;
will return &lsquo;<samp><span class="samp">9.26535897932e-5</span></samp>&rsquo; (computing a 25-digit result which
is then rounded down to 12); and &lsquo;<samp><span class="samp">evalvn(pi - 3.1415, [-2])</span></samp>&rsquo;
will return &lsquo;<samp><span class="samp">9.2654e-5</span></samp>&rsquo;.

   <p><a name="index-a-_0022-1674"></a><a name="index-calc_002dexpand_002dformula-1675"></a>The <kbd>a "</kbd> (<code>calc-expand-formula</code>) command expands functions
into their defining formulas wherever possible.  For example,
&lsquo;<samp><span class="samp">deg(x^2)</span></samp>&rsquo; is changed to &lsquo;<samp><span class="samp">180 x^2 / pi</span></samp>&rsquo;.  Most functions,
like <code>sin</code> and <code>gcd</code>, are not defined by simple formulas
and so are unaffected by this command.  One important class of
functions which <em>can</em> be expanded is the user-defined functions
created by the <kbd>Z F</kbd> command.  See <a href="Algebraic-Definitions.html#Algebraic-Definitions">Algebraic Definitions</a>. 
Other functions which <kbd>a "</kbd> can expand include the probability
distribution functions, most of the financial functions, and the
hyperbolic and inverse hyperbolic functions.  A numeric prefix argument
affects <kbd>a "</kbd> in the same way as it does <kbd>a v</kbd>:  A positive
argument expands all functions in the formula and then simplifies in
various ways; a negative argument expands and simplifies only the
top-level function call.

   <p><a name="index-a-M-1676"></a><a name="index-calc_002dmap_002dequation-1677"></a><a name="index-mapeq-1678"></a>The <kbd>a M</kbd> (<code>calc-map-equation</code>) [<code>mapeq</code>] command applies
a given function or operator to one or more equations.  It is analogous
to <kbd>V M</kbd>, which operates on vectors instead of equations. 
see <a href="Reducing-and-Mapping.html#Reducing-and-Mapping">Reducing and Mapping</a>.  For example, <kbd>a M S</kbd> changes
&lsquo;<samp><span class="samp">x = y+1</span></samp>&rsquo; to &lsquo;<samp><span class="samp">sin(x) = sin(y+1)</span></samp>&rsquo;, and <kbd>a M +</kbd> with
&lsquo;<samp><span class="samp">x = y+1</span></samp>&rsquo; and &lsquo;<samp><span class="samp">6</span></samp>&rsquo; on the stack produces &lsquo;<samp><span class="samp">x+6 = y+7</span></samp>&rsquo;. 
With two equations on the stack, <kbd>a M +</kbd> would add the lefthand
sides together and the righthand sides together to get the two
respective sides of a new equation.

   <p>Mapping also works on inequalities.  Mapping two similar inequalities
produces another inequality of the same type.  Mapping an inequality
with an equation produces an inequality of the same type.  Mapping a
&lsquo;<samp><span class="samp">&lt;=</span></samp>&rsquo; with a &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo; or &lsquo;<samp><span class="samp">!=</span></samp>&rsquo; (not-equal) produces a &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo;. 
If inequalities with opposite direction (e.g., &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo; and &lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo;)
are mapped, the direction of the second inequality is reversed to
match the first:  Using <kbd>a M +</kbd> on &lsquo;<samp><span class="samp">a &lt; b</span></samp>&rsquo; and &lsquo;<samp><span class="samp">a &gt; 2</span></samp>&rsquo;
reverses the latter to get &lsquo;<samp><span class="samp">2 &lt; a</span></samp>&rsquo;, which then allows the
combination &lsquo;<samp><span class="samp">a + 2 &lt; b + a</span></samp>&rsquo;, which the <kbd>a s</kbd> command can
then simplify to get &lsquo;<samp><span class="samp">2 &lt; b</span></samp>&rsquo;.

   <p>Using <kbd>a M *</kbd>, <kbd>a M /</kbd>, <kbd>a M n</kbd>, or <kbd>a M &amp;</kbd> to negate
or invert an inequality will reverse the direction of the inequality. 
Other adjustments to inequalities are <em>not</em> done automatically;
<kbd>a M S</kbd> will change &lsquo;<samp><span class="samp">x&nbsp;&lt;&nbsp;y</span></samp>&rsquo;<!-- /@w --> to &lsquo;<samp><span class="samp">sin(x) &lt; sin(y)</span></samp>&rsquo; even
though this is not true for all values of the variables.

   <p><a name="index-H-a-M-1679"></a><a name="index-mapeqp-1680"></a>With the Hyperbolic flag, <kbd>H a M</kbd> [<code>mapeqp</code>] does a plain
mapping operation without reversing the direction of any inequalities. 
Thus, <kbd>H a M &amp;</kbd> would change <kbd>x &gt; 2</kbd> to <kbd>1/x &gt; 0.5</kbd>. 
(This change is mathematically incorrect, but perhaps you were
fixing an inequality which was already incorrect.)

   <p><a name="index-I-a-M-1681"></a><a name="index-mapeqr-1682"></a>With the Inverse flag, <kbd>I a M</kbd> [<code>mapeqr</code>] always reverses
the direction of the inequality.  You might use <kbd>I a M C</kbd> to
change &lsquo;<samp><span class="samp">x &lt; y</span></samp>&rsquo; to &lsquo;<samp><span class="samp">cos(x) &gt; cos(y)</span></samp>&rsquo; if you know you are
working with small positive angles.

   <p><a name="index-a-b-1683"></a><a name="index-calc_002dsubstitute-1684"></a><a name="index-subst-1685"></a>The <kbd>a b</kbd> (<code>calc-substitute</code>) [<code>subst</code>] command substitutes
all occurrences
of some variable or sub-expression of an expression with a new
sub-expression.  For example, substituting &lsquo;<samp><span class="samp">sin(x)</span></samp>&rsquo; with &lsquo;<samp><span class="samp">cos(y)</span></samp>&rsquo;
in &lsquo;<samp><span class="samp">2 sin(x)^2 + x sin(x) + sin(2 x)</span></samp>&rsquo; produces
&lsquo;<samp><span class="samp">2 cos(y)^2 + x cos(y) + sin(2&nbsp;x)<!-- /@w --></span></samp>&rsquo;. 
Note that this is a purely structural substitution; the lone &lsquo;<samp><span class="samp">x</span></samp>&rsquo; and
the &lsquo;<samp><span class="samp">sin(2 x)</span></samp>&rsquo; stayed the same because they did not look like
&lsquo;<samp><span class="samp">sin(x)</span></samp>&rsquo;.  See <a href="Rewrite-Rules.html#Rewrite-Rules">Rewrite Rules</a>, for a more general method for
doing substitutions.

   <p>The <kbd>a b</kbd> command normally prompts for two formulas, the old
one and the new one.  If you enter a blank line for the first
prompt, all three arguments are taken from the stack (new, then old,
then target expression).  If you type an old formula but then enter a
blank line for the new one, the new formula is taken from top-of-stack
and the target from second-to-top.  If you answer both prompts, the
target is taken from top-of-stack as usual.

   <p>Note that <kbd>a b</kbd> has no understanding of commutativity or
associativity.  The pattern &lsquo;<samp><span class="samp">x+y</span></samp>&rsquo; will not match the formula
&lsquo;<samp><span class="samp">y+x</span></samp>&rsquo;.  Also, &lsquo;<samp><span class="samp">y+z</span></samp>&rsquo; will not match inside the formula &lsquo;<samp><span class="samp">x+y+z</span></samp>&rsquo;
because the &lsquo;<samp><span class="samp">+</span></samp>&rsquo; operator is left-associative, so the &ldquo;deep
structure&rdquo; of that formula is &lsquo;<samp><span class="samp">(x+y) + z</span></samp>&rsquo;.  Use <kbd>d U</kbd>
(<code>calc-unformatted-language</code>) mode to see the true structure of
a formula.  The rewrite rule mechanism, discussed later, does not have
these limitations.

   <p>As an algebraic function, <code>subst</code> takes three arguments:
Target expression, old, new.  Note that <code>subst</code> is always
evaluated immediately, even if its arguments are variables, so if
you wish to put a call to <code>subst</code> onto the stack you must
turn the default simplifications off first (with <kbd>m O</kbd>).

   </body></html>


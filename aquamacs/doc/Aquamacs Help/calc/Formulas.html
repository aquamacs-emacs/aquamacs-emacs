<html lang="en">
<head>
<title>Formulas - GNU Emacs Calc Manual</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Emacs Calc Manual">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Data-Types.html#Data-Types" title="Data Types">
<link rel="prev" href="Variables.html#Variables" title="Variables">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This file documents Calc, the GNU Emacs calculator, included with GNU Emacs 23.1.

Copyright (C) 1990, 1991, 2001, 2002, 2003, 2004,
2005, 2006, 2007, 2008, 2009, 2010 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with the Invariant Sections being just ``GNU GENERAL
     PUBLIC LICENSE'', with the Front-Cover texts being ``A GNU
     Manual,'' and with the Back-Cover Texts as in (a) below.  A copy
     of the license is included in the section entitled ``GNU Free
     Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Formulas"></a>
<p>
Previous:&nbsp;<a rel="previous" accesskey="p" href="Variables.html#Variables">Variables</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Data-Types.html#Data-Types">Data Types</a>
<hr>
</div>

<h3 class="section">5.15 Formulas</h3>

<p class="noindent"><a name="index-Formulas-315"></a><a name="index-Expressions-316"></a><a name="index-Operators-in-formulas-317"></a><a name="index-Precedence-of-operators-318"></a>When you press the apostrophe key you may enter any expression or formula
in algebraic form.  (Calc uses the terms &ldquo;expression&rdquo; and &ldquo;formula&rdquo;
interchangeably.)  An expression is built up of numbers, variable names,
and function calls, combined with various arithmetic operators. 
Parentheses may
be used to indicate grouping.  Spaces are ignored within formulas, except
that spaces are not permitted within variable names or numbers. 
Arithmetic operators, in order from highest to lowest precedence, and
with their equivalent function names, are:

   <p>&lsquo;<samp><span class="samp">_</span></samp>&rsquo; [<code>subscr</code>] (subscripts);

   <p>postfix &lsquo;<samp><span class="samp">%</span></samp>&rsquo; [<code>percent</code>] (as in &lsquo;<samp><span class="samp">25% = 0.25</span></samp>&rsquo;);

   <p>prefix &lsquo;<samp><span class="samp">!</span></samp>&rsquo; [<code>lnot</code>] (logical &ldquo;not,&rdquo; as in &lsquo;<samp><span class="samp">!x</span></samp>&rsquo;);

   <p>&lsquo;<samp><span class="samp">+/-</span></samp>&rsquo; [<code>sdev</code>] (the standard deviation symbol) and
&lsquo;<samp><span class="samp">mod</span></samp>&rsquo; [<code>makemod</code>] (the symbol for modulo forms);

   <p>postfix &lsquo;<samp><span class="samp">!</span></samp>&rsquo; [<code>fact</code>] (factorial, as in &lsquo;<samp><span class="samp">n!</span></samp>&rsquo;)
and postfix &lsquo;<samp><span class="samp">!!</span></samp>&rsquo; [<code>dfact</code>] (double factorial);

   <p>&lsquo;<samp><span class="samp">^</span></samp>&rsquo; [<code>pow</code>] (raised-to-the-power-of);

   <p>prefix &lsquo;<samp><span class="samp">+</span></samp>&rsquo; and &lsquo;<samp><span class="samp">-</span></samp>&rsquo; [<code>neg</code>] (as in &lsquo;<samp><span class="samp">-x</span></samp>&rsquo;);

   <p>&lsquo;<samp><span class="samp">*</span></samp>&rsquo; [<code>mul</code>];

   <p>&lsquo;<samp><span class="samp">/</span></samp>&rsquo; [<code>div</code>], &lsquo;<samp><span class="samp">%</span></samp>&rsquo; [<code>mod</code>] (modulo), and
&lsquo;<samp><span class="samp">\</span></samp>&rsquo; [<code>idiv</code>] (integer division);

   <p>infix &lsquo;<samp><span class="samp">+</span></samp>&rsquo; [<code>add</code>] and &lsquo;<samp><span class="samp">-</span></samp>&rsquo; [<code>sub</code>] (as in &lsquo;<samp><span class="samp">x-y</span></samp>&rsquo;);

   <p>&lsquo;<samp><span class="samp">|</span></samp>&rsquo; [<code>vconcat</code>] (vector concatenation);

   <p>relations &lsquo;<samp><span class="samp">=</span></samp>&rsquo; [<code>eq</code>], &lsquo;<samp><span class="samp">!=</span></samp>&rsquo; [<code>neq</code>], &lsquo;<samp><span class="samp">&lt;</span></samp>&rsquo; [<code>lt</code>],
&lsquo;<samp><span class="samp">&gt;</span></samp>&rsquo; [<code>gt</code>], &lsquo;<samp><span class="samp">&lt;=</span></samp>&rsquo; [<code>leq</code>], and &lsquo;<samp><span class="samp">&gt;=</span></samp>&rsquo; [<code>geq</code>];

   <p>&lsquo;<samp><span class="samp">&amp;&amp;</span></samp>&rsquo; [<code>land</code>] (logical &ldquo;and&rdquo;);

   <p>&lsquo;<samp><span class="samp">||</span></samp>&rsquo; [<code>lor</code>] (logical &ldquo;or&rdquo;);

   <p>the C-style &ldquo;if&rdquo; operator &lsquo;<samp><span class="samp">a?b:c</span></samp>&rsquo; [<code>if</code>];

   <p>&lsquo;<samp><span class="samp">!!!</span></samp>&rsquo; [<code>pnot</code>] (rewrite pattern &ldquo;not&rdquo;);

   <p>&lsquo;<samp><span class="samp">&amp;&amp;&amp;</span></samp>&rsquo; [<code>pand</code>] (rewrite pattern &ldquo;and&rdquo;);

   <p>&lsquo;<samp><span class="samp">|||</span></samp>&rsquo; [<code>por</code>] (rewrite pattern &ldquo;or&rdquo;);

   <p>&lsquo;<samp><span class="samp">:=</span></samp>&rsquo; [<code>assign</code>] (for assignments and rewrite rules);

   <p>&lsquo;<samp><span class="samp">::</span></samp>&rsquo; [<code>condition</code>] (rewrite pattern condition);

   <p>&lsquo;<samp><span class="samp">=&gt;</span></samp>&rsquo; [<code>evalto</code>].

   <p>Note that, unlike in usual computer notation, multiplication binds more
strongly than division:  &lsquo;<samp><span class="samp">a*b/c*d</span></samp>&rsquo; is equivalent to
<!-- @math{a b \over c d}. -->
&lsquo;<samp><span class="samp">(a*b)/(c*d)</span></samp>&rsquo;.

   <p><a name="index-Multiplication_002c-implicit-319"></a><a name="index-Implicit-multiplication-320"></a>The multiplication sign &lsquo;<samp><span class="samp">*</span></samp>&rsquo; may be omitted in many cases.  In particular,
if the righthand side is a number, variable name, or parenthesized
expression, the &lsquo;<samp><span class="samp">*</span></samp>&rsquo; may be omitted.  Implicit multiplication has the
same precedence as the explicit &lsquo;<samp><span class="samp">*</span></samp>&rsquo; operator.  The one exception to
the rule is that a variable name followed by a parenthesized expression,
as in &lsquo;<samp><span class="samp">f(x)</span></samp>&rsquo;,
is interpreted as a function call, not an implicit &lsquo;<samp><span class="samp">*</span></samp>&rsquo;.  In many
cases you must use a space if you omit the &lsquo;<samp><span class="samp">*</span></samp>&rsquo;:  &lsquo;<samp><span class="samp">2a</span></samp>&rsquo; is the
same as &lsquo;<samp><span class="samp">2*a</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">a b</span></samp>&rsquo; is the same as &lsquo;<samp><span class="samp">a*b</span></samp>&rsquo;, but &lsquo;<samp><span class="samp">ab</span></samp>&rsquo;
is a variable called <code>ab</code>, <em>not</em> the product of &lsquo;<samp><span class="samp">a</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">b</span></samp>&rsquo;!  Also note that &lsquo;<samp><span class="samp">f (x)</span></samp>&rsquo; is still a function call.

   <p><a name="index-Implicit-comma-in-vectors-321"></a>The rules are slightly different for vectors written with square brackets. 
In vectors, the space character is interpreted (like the comma) as a
separator of elements of the vector.  Thus &lsquo;<samp><span class="samp">[&nbsp;2a&nbsp;b+c&nbsp;d&nbsp;]</span></samp>&rsquo;<!-- /@w --> is
equivalent to &lsquo;<samp><span class="samp">[2*a, b+c, d]</span></samp>&rsquo;, whereas &lsquo;<samp><span class="samp">2a b+c d</span></samp>&rsquo; is equivalent
to &lsquo;<samp><span class="samp">2*a*b + c*d</span></samp>&rsquo;. 
Note that spaces around the brackets, and around explicit commas, are
ignored.  To force spaces to be interpreted as multiplication you can
enclose a formula in parentheses as in &lsquo;<samp><span class="samp">[(a b) 2(c d)]</span></samp>&rsquo;, which is
interpreted as &lsquo;<samp><span class="samp">[a*b, 2*c*d]</span></samp>&rsquo;.  An implicit comma is also inserted
between &lsquo;<samp><span class="samp">][</span></samp>&rsquo;, as in the matrix &lsquo;<samp><span class="samp">[[1 2][3 4]]</span></samp>&rsquo;.

   <p>Vectors that contain commas (not embedded within nested parentheses or
brackets) do not treat spaces specially:  &lsquo;<samp><span class="samp">[a b, 2 c d]</span></samp>&rsquo; is a vector
of two elements.  Also, if it would be an error to treat spaces as
separators, but not otherwise, then Calc will ignore spaces:
&lsquo;<samp><span class="samp">[a&nbsp;-&nbsp;b]</span></samp>&rsquo;<!-- /@w --> is a vector of one element, but &lsquo;<samp><span class="samp">[a&nbsp;-b]</span></samp>&rsquo;<!-- /@w --> is
a vector of two elements.  Finally, vectors entered with curly braces
instead of square brackets do not give spaces any special treatment. 
When Calc displays a vector that does not contain any commas, it will
insert parentheses if necessary to make the meaning clear:
&lsquo;<samp><span class="samp">[(a&nbsp;b)]</span></samp>&rsquo;<!-- /@w -->.

   <p>The expression &lsquo;<samp><span class="samp">5%-2</span></samp>&rsquo; is ambiguous; is this five-percent minus two,
or five modulo minus-two?  Calc always interprets the leftmost symbol as
an infix operator preferentially (modulo, in this case), so you would
need to write &lsquo;<samp><span class="samp">(5%)-2</span></samp>&rsquo; to get the former interpretation.

   <p><a name="index-Function-call-notation-322"></a>A function call is, e.g., &lsquo;<samp><span class="samp">sin(1+x)</span></samp>&rsquo;.  (The Calc algebraic function
<code>foo</code> corresponds to the Emacs Lisp function <code>calcFunc-foo</code>,
but unless you access the function from within Emacs Lisp, you don't
need to worry about it.)  Most mathematical Calculator commands like
<code>calc-sin</code> have function equivalents like <code>sin</code>. 
If no Lisp function is defined for a function called by a formula, the
call is left as it is during algebraic manipulation: &lsquo;<samp><span class="samp">f(x+y)</span></samp>&rsquo; is
left alone.  Beware that many innocent-looking short names like <code>in</code>
and <code>re</code> have predefined meanings which could surprise you; however,
single letters or single letters followed by digits are always safe to
use for your own function names.  See <a href="Function-Index.html#Function-Index">Function Index</a>.

   <p>In the documentation for particular commands, the notation <kbd>H S</kbd>
(<code>calc-sinh</code>) [<code>sinh</code>] means that the key sequence <kbd>H S</kbd>, the
command <kbd>M-x calc-sinh</kbd>, and the algebraic function <code>sinh(x)</code> all
represent the same operation.

   <p>Commands that interpret (&ldquo;parse&rdquo;) text as algebraic formulas include
algebraic entry (<kbd>'</kbd>), editing commands like <kbd>`</kbd> which parse
the contents of the editing buffer when you finish, the <kbd>C-x * g</kbd>
and <kbd>C-x&nbsp;*&nbsp;r</kbd><!-- /@w --> commands, the <kbd>C-y</kbd> command, the X window system
&ldquo;paste&rdquo; mouse operation, and Embedded mode.  All of these operations
use the same rules for parsing formulas; in particular, language modes
(see <a href="Language-Modes.html#Language-Modes">Language Modes</a>) affect them all in the same way.

   <p>When you read a large amount of text into the Calculator (say a vector
which represents a big set of rewrite rules; see <a href="Rewrite-Rules.html#Rewrite-Rules">Rewrite Rules</a>),
you may wish to include comments in the text.  Calc's formula parser
ignores the symbol &lsquo;<samp><span class="samp">%%</span></samp>&rsquo; and anything following it on a line:

<pre class="example">     [ a + b,   %% the sum of "a" and "b"
       c + d,
       %% last line is coming up:
       e + f ]
</pre>
   <p class="noindent">This is parsed exactly the same as &lsquo;<samp><span class="samp">[ a + b, c + d, e + f ]</span></samp>&rsquo;.

   <p>See <a href="Syntax-Tables.html#Syntax-Tables">Syntax Tables</a>, for a way to create your own operators and other
input notations.  See <a href="Compositions.html#Compositions">Compositions</a>, for a way to create new display
formats.

   <p>See <a href="Algebra.html#Algebra">Algebra</a>, for commands for manipulating formulas symbolically.

   </body></html>


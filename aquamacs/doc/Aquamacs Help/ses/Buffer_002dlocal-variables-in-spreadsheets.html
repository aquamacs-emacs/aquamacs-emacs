<html lang="en">
<head>
<title>Buffer-local variables in spreadsheets - SES: Simple Emacs Spreadsheet</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="SES: Simple Emacs Spreadsheet">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="For-Gurus.html#For-Gurus" title="For Gurus">
<link rel="prev" href="The-data-area.html#The-data-area" title="The data area">
<link rel="next" href="Uses-of-defadvice-in-SES.html#Uses-of-defadvice-in-SES" title="Uses of defadvice in SES">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This file documents SES: the Simple Emacs Spreadsheet.

Copyright (C) 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,
2010 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with the Front-Cover texts
     being ``A GNU Manual,'' and with the Back-Cover Texts as in (a)
     below.  A copy of the license is included in the section entitled
     ``GNU Free Documentation License.''

     (a) The FSF's Back-Cover Text is: ``You have the freedom to copy
     and modify this GNU manual.  Buying copies from the FSF supports
     it in developing GNU and promoting software freedom.''
   -->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Buffer-local-variables-in-spreadsheets"></a>
<a name="Buffer_002dlocal-variables-in-spreadsheets"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Uses-of-defadvice-in-SES.html#Uses-of-defadvice-in-SES">Uses of defadvice in SES</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="The-data-area.html#The-data-area">The data area</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="For-Gurus.html#For-Gurus">For Gurus</a>
<hr>
</div>

<h3 class="section">4.4 Buffer-local variables in spreadsheets</h3>

<p><a name="index-buffer_002dlocal-variables-93"></a><a name="index-variables_002c-buffer_002dlocal-94"></a>
You can add additional local variables to the list at the bottom of
the data area, such as hidden constants you want to refer to in your
formulas.

   <p>You can override the variable <code>ses--symbolic-formulas</code> to be a list of
symbols (as parenthesized strings) to show as completions for the '
command.  This initial completions list is used instead of the actual
set of symbols-as-formulas in the spreadsheet.

   <p>For an example of this, see file <samp><span class="file">etc/ses-example.ses</span></samp>.

   <p>If (for some reason) you want your formulas or printers to save data
into variables, you must declare these variables as buffer-locals in
order to avoid a virus warning.

   <p>You can define functions by making them values for the fake local
variable <code>eval</code>.  Such functions can then be used in your
formulas and printers, but usually each <code>eval</code> is presented to
the user during file loading as a potential virus &mdash; this can get
annoying.

   <p>You can define functions in your <samp><span class="file">.emacs</span></samp> file.  Other people can
still read the print area of your spreadsheet, but they won't be able
to recalculate or reprint anything that depends on your functions.  To
avoid virus warnings, each function used in a formula needs
<pre class="lisp">     (put 'your-function-name 'safe-function t)
</pre>
   </body></html>

